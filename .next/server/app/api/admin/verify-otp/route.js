"use strict";(()=>{var e={};e.id=845,e.ids=[845],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1305:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>c,patchFetch:()=>P,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>f});var s={};r.r(s),r.d(s,{POST:()=>u});var a=r(9303),o=r(8716),n=r(670),i=r(7070);let p=new Map;async function u(e){try{let{otp:t}=await e.json(),r=e.ip||e.headers.get("x-forwarded-for")||"unknown",s=`otp_${r}`,a=p.get(s);if(!a)return i.NextResponse.json({error:"No OTP found. Please request a new one."},{status:400});if(Date.now()>a.expires)return p.delete(s),i.NextResponse.json({error:"OTP has expired. Please request a new one."},{status:400});if(a.attempts>=3)return p.delete(s),i.NextResponse.json({error:"Too many failed attempts. Please request a new OTP."},{status:400});if(t!==a.otp)return a.attempts++,p.set(s,a),i.NextResponse.json({error:"Invalid OTP. Please try again."},{status:400});return p.delete(s),i.NextResponse.json({message:"OTP verified successfully",authenticated:!0})}catch(e){return console.error("Error verifying OTP:",e),i.NextResponse.json({error:"Failed to verify OTP. Please try again."},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/admin/verify-otp/route",pathname:"/api/admin/verify-otp",filename:"route",bundlePath:"app/api/admin/verify-otp/route"},resolvedPagePath:"/Users/surafellemma/Desktop/Fifi Hair Salon/app/api/admin/verify-otp/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:f,serverHooks:m}=d,c="/api/admin/verify-otp/route";function P(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:f})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,972],()=>r(1305));module.exports=s})();