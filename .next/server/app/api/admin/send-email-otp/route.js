"use strict";(()=>{var e={};e.id=345,e.ids=[345],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4623:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>f,patchFetch:()=>P,requestAsyncStorage:()=>c,routeModule:()=>m,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var n={};o.r(n),o.d(n,{POST:()=>d});var r=o(9303),a=o(8716),i=o(670),s=o(7070);let l=new Map,u=new Map,p="fifi.hair.salon@gmail.com";async function d(e){try{let t=e.ip||e.headers.get("x-forwarded-for")||"unknown";if(!function(e){let t=Date.now(),o=`rate_limit_${e}`,n=u.get(o);return!n||t>n.resetTime?(u.set(o,{count:1,resetTime:t+3e5}),!0):!(n.count>=3)&&(n.count++,!0)}(t))return s.NextResponse.json({error:"Too many requests. Please try again in 5 minutes."},{status:429});let o=Math.floor(1e4+9e4*Math.random()).toString(),n=Date.now()+6e5,r=`otp_${t}`;return l.set(r,{otp:o,expires:n,attempts:0}),console.log(`
ðŸ“§ EMAIL OTP GENERATED:`),console.log(`ðŸ“§ Email: ${p}`),console.log(`ðŸ”‘ OTP Code: ${o}`),console.log(`â° Expires: 10 minutes`),console.log(`
ðŸ’¡ To test: Go to http://localhost:3001/admin-verify and enter: ${o}`),console.log(`
ðŸ“§ In production, this would send an email to: ${p}`),console.log(`ðŸ“§ Email subject: "Fifi Hair Salon - Admin Login OTP"`),console.log(`ðŸ“§ Email body: "Your admin login OTP is: ${o}. This code expires in 10 minutes."
`),s.NextResponse.json({message:`OTP generated! Check terminal for code: ${o}`,devOtp:o,instructions:"Enter the OTP from your terminal to continue",email:p})}catch(e){return console.error("Error generating OTP:",e),s.NextResponse.json({error:"Failed to generate OTP. Please try again."},{status:500})}}let m=new r.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/admin/send-email-otp/route",pathname:"/api/admin/send-email-otp",filename:"route",bundlePath:"app/api/admin/send-email-otp/route"},resolvedPagePath:"/Users/surafellemma/Desktop/Fifi Hair Salon/app/api/admin/send-email-otp/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:c,staticGenerationAsyncStorage:g,serverHooks:h}=m,f="/api/admin/send-email-otp/route";function P(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),n=t.X(0,[948,972],()=>o(4623));module.exports=n})();